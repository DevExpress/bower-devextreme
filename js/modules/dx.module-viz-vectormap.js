/*! 
* DevExtreme (Vector Map)
* Version: 15.2.9
* Build date: Apr 7, 2016
*
* Copyright (c) 2012 - 2016 Developer Express Inc. ALL RIGHTS RESERVED
* EULA: https://www.devexpress.com/Support/EULAs/DevExtreme.xml
*/
"use strict";if(!window.DevExpress||!DevExpress.MOD_VIZ_VECTORMAP){if(!window.DevExpress||!DevExpress.MOD_VIZ_CORE)throw Error("Required module is not referenced: viz-core");(function(n,t,i){function v(){return"vectormap-data-"+c++}function p(n,r){function u(n){n=n||{};var t=n.data;return n.data=i,{data:t}}r&&(n.__data=r.length?t.map(r,u):u(r))}function w(n,r,u){var f=n.__data;f&&(n.__data=i,f.length?t.each(f,function(n,t){r[n].data=t.data}):r.data=f.data,u.lock(),n.setOptions(r),u.unlock())}function b(t){var r=n.require("/errors").log,u=t._options.mapData,e=t._options.markers;t._options.mapData=t._options.markers=i,t._afterInit=function(){this._options.mapData=u,this._options.markers=e,this._renderer.lock(),this._setLayerCollectionOptions(),this._renderer.unlock(),u=e=i},t._setLayerCollectionOptions=function(){var n=this._options,t=n.mapData,i=n.markers;t=t&&t.features?f({},t):t,i=i&&i.features?f({},i):i,this._layerCollection.setOptions([f({},n.areaSettings,{name:"areas",_deprecated:!0,data:t,type:"area"}),f({},n.markerSettings,{name:"markers",_deprecated:!0,data:i,type:"marker",elementType:n.markerSettings&&n.markerSettings.type})])},t.getAreas=function(){return r("W0002",this.NAME,"getAreas","15.2","Use the 'getLayerByName('areas').getElements()' instead"),this.getLayerByName("areas").getElements()},t.getMarkers=function(){return r("W0002",this.NAME,"getMarkers","15.2","Use the 'getLayerByName('markers').getElements()' instead"),this.getLayerByName("markers").getElements()},t.clearAreaSelection=function(n){return r("W0002",this.NAME,"clearAreaSelection","15.2","Use the 'getLayerByName('areas').clearSelection()' instead"),this.getLayerByName("areas").clearSelection(n),this},t.clearMarkerSelection=function(n){return r("W0002",this.NAME,"clearMarkerSelection","15.2","Use the 'getLayerByName('markers').clearSelection()' instead"),this.getLayerByName("markers").clearSelection(n),this};var o={areas:"areaClick",markers:"markerClick"},s={areas:"areaHoverChanged",markers:"markerHoverChanged"},h={areas:"areaSelectionChanged",markers:"markerSelectionChanged"};t.on("click",function(n){n.target&&this._eventTrigger(o[n.target.layer.name],n)});t.on("hoverChanged",function(n){n.target&&this._eventTrigger(s[n.target.layer.name],n)});t.on("selectionChanged",function(n){n.target&&this._eventTrigger(h[n.target.layer.name],n)})}var r=n.viz.map={},e=n.viz.utils.parseScalar,o=n.require("/componentRegistrator"),u=t.noop,f=t.extend,s=800,h=400,c=1,l=/^layers/,a=/\.data$/,y=n.viz.BaseWidget.inherit({_eventsMap:f({},n.viz.BaseWidget.prototype._eventsMap,{onClick:{name:"click"},onCenterChanged:{name:"centerChanged"},onZoomFactorChanged:{name:"zoomFactorChanged"},onAreaClick:{name:"areaClick"},onAreaHoverChanged:{name:"areaHoverChanged"},onAreaSelectionChanged:{name:"areaSelectionChanged"},onMarkerClick:{name:"markerClick"},onMarkerHoverChanged:{name:"markerHoverChanged"},onMarkerSelectionChanged:{name:"markerSelectionChanged"},onHoverChanged:{name:"hoverChanged"},onSelectionChanged:{name:"selectionChanged"}}),_setDeprecatedOptions:function(){this.callBase.apply(this,arguments),f(this._deprecatedOptions,{areaSettings:{since:"15.2",message:"Use the 'layers' option instead"},markerSettings:{since:"15.2",message:"Use the 'layers' option instead"},mapData:{since:"15.2",message:"Use the 'layers' option instead"},markers:{since:"15.2",message:"Use the 'layers' option instead"},onAreaClick:{since:"15.2",message:"Use the 'onClick' option instead"},onMarkerClick:{since:"15.2",message:"Use the 'onClick' option instead"},onAreaHoverChanged:{since:"15.2",message:"Use the 'onHoverChanged' option instead"},onMarkerHoverChanged:{since:"15.2",message:"Use the 'onHoverChanged' option instead"},onAreaSelectionChanged:{since:"15.2",message:"Use the 'onSelectionChanged' option instead"},onMarkerSelectionChanged:{since:"15.2",message:"Use the 'onSelectionChanged' option instead"}})},_rootClassPrefix:"dxm",_rootClass:"dxm-vector-map",_createThemeManager:function(){return new r.ThemeManager},_initLayerCollection:function(n,t,u){var f=this;f._layerCollection=new r.MapLayerCollection({renderer:f._renderer,projection:f._projection,themeManager:f._themeManager,tracker:f._tracker,dataKey:n,eventTrigger:f._eventTrigger,dataExchanger:f._dataExchanger,tooltip:f._tooltip,notifyDirty:t,notifyReady:u}),f._options.layers===i&&(f._options.mapData||f._options.markers)?b(f):p(f._layerCollection,f._options.layers)},_initLegendsControl:function(n,t){var i=this;i._legendsControl=new r.LegendsControl({renderer:i._renderer,container:i._root,layoutControl:i._layoutControl,themeManager:i._themeManager,dataExchanger:i._dataExchanger,notifyDirty:n,notifyReady:t})},_initControlBar:function(n){var t=this;t._controlBar=new r.ControlBar({renderer:t._renderer,container:t._root,layoutControl:t._layoutControl,projection:t._projection,tracker:t._tracker,dataKey:n})},_initProjection:function(){var n=this,t=n._projection;t.setEngine(n.option("projection")),t.setBounds(n.option("bounds")),t.setMaxZoom(n.option("maxZoomFactor")),t.setZoom(n.option("zoomFactor")),t.setCenter(n.option("center"))},_initElements:function(){function u(){n._resetIsReady(),++i}function f(){--i==0&&(n._drawn(),n._fulfillLoadingIndicatorHiding())}var n=this,t=v(),i=0;n._dataExchanger=new r.DataExchanger,n._projection=new r.Projection({centerChanged:function(t){n._initialized&&n._eventTrigger("centerChanged",{center:t})},zoomChanged:function(t){n._initialized&&n._eventTrigger("zoomFactorChanged",{zoomFactor:t})}}),n._tracker=new r.Tracker({root:n._root,projection:n._projection,dataKey:t}),n._gestureHandler=new r.GestureHandler({projection:n._projection,renderer:n._renderer,tracker:n._tracker}),n._layoutControl=new r.LayoutControl,n._layoutControl.suspend(),n._initLayerCollection(t,u,f),n._initControlBar(t),n._initLegendsControl(u,f),n._tooltipViewer=new r.TooltipViewer({tracker:n._tracker,tooltip:n._tooltip,layerCollection:n._layerCollection})},_init:function(){this.callBase.apply(this,arguments),this._afterInit(),this._layoutControl.resume()},_afterInit:function(){w(this._layerCollection,this._options.layers,this._renderer)},_initCore:function(){this._root=this._renderer.root.attr({align:"center",cursor:"default"}),this._initElements(),this._initProjection()},_disposeCore:function(){var n=this;n._controlBar.dispose(),n._gestureHandler.dispose(),n._tracker.dispose(),n._legendsControl.dispose(),n._layerCollection.dispose(),n._layoutControl.dispose(),n._tooltipViewer.dispose(),n._dataExchanger.dispose(),n._projection.dispose(),n._dataExchanger=n._gestureHandler=n._projection=n._tracker=n._layoutControl=n._root=n._layerCollection=n._controlBar=n._legendsControl=null},_setupInteraction:function(){var n={centeringEnabled:!!e(this._getOption("panningEnabled",!0),!0),zoomingEnabled:!!e(this._getOption("zoomingEnabled",!0),!0)};this._gestureHandler.setInteraction(n),this._controlBar.setInteraction(n)},_getDefaultSize:function(){return{width:s,height:h}},_getTitleLayoutSize:function(){var n=this._canvas,t=this._title,r=t.getVerticalCuttedSize(n),i=t.getLayoutOptions();return i&&t.position({at:i.position,my:i.position,of:{getLayoutOptions:function(){return{width:n.width,height:n.height,x:0,y:0}}}}),r},_applySize:function(){var t=this,n;t._renderer.lock(),n=t._getTitleLayoutSize(),t._projection.setSize(n),t._layoutControl.setSize(n),t._renderer.unlock(),t._layerCollection.setRect([n.left,n.top,n.width,n.height])},_initDataSource:u,_disposeDataSource:u,_optionChanging:function(n,t,i){t&&i&&(l.test(n)&&(t.data&&i.data&&t!==i?t.data=null:a.test(n)&&this.option(n,null)),n==="mapData"&&(this._options.mapData=null),n==="markers"&&(this._options.markers=null))},_handleChangedOptions:function(n){var t=this;t.callBase.apply(t,arguments),"background"in n&&t._setBackgroundOptions(),("layers"in n||"areaSettings"in n||"markerSettings"in n||"mapData"in n||"markers"in n)&&t._setLayerCollectionOptions(),"controlBar"in n&&t._setControlBarOptions(),"legends"in n&&t._setLegendsOptions(),("touchEnabled"in n||"wheelEnabled"in n)&&t._setTrackerOptions(),("panningEnabled"in n||"zoomingEnabled"in n)&&t._setupInteraction(),"projection"in n&&t._projection.setEngine(n.projection),"bounds"in n&&t._projection.setBounds(n.bounds),"maxZoomFactor"in n&&t._projection.setMaxZoom(n.maxZoomFactor),"zoomFactor"in n&&t._projection.setZoom(n.zoomFactor),"center"in n&&t._projection.setCenter(n.center)},_handleThemeOptionsCore:function(){var n=this;n._scheduleLoadingIndicatorHiding(),n._setBackgroundOptions(),n._setLayerCollectionOptions(),n._layoutControl.suspend(),n._setControlBarOptions(),n._setLegendsOptions(),n._setTrackerOptions(),n._setupInteraction(),n._layoutControl.resume()},_setBackgroundOptions:function(){this._layerCollection.setBackgroundOptions(this._getOption("background"))},_setLayerCollectionOptions:function(){this._layerCollection.setOptions(this.option("layers"))},_setControlBarOptions:function(){this._controlBar.setOptions(this._getOption("controlBar"))},_setLegendsOptions:function(){this._legendsControl.setOptions(this.option("legends"))},_setTrackerOptions:function(){this._tracker.setOptions({touchEnabled:this._getOption("touchEnabled",!0),wheelEnabled:this._getOption("wheelEnabled",!0)})},getLayers:function(){for(var i=this._layerCollection.items(),t=[],r=t.length=i.length,n=0;n<r;++n)t[n]=i[n].proxy;return t},getLayerByIndex:function(n){var t=this._layerCollection.byIndex(n);return t?t.proxy:null},getLayerByName:function(n){var t=this._layerCollection.byName(n);return t?t.proxy:null},clearSelection:function(n){for(var i=this._layerCollection.items(),r=i.length,t=0;t<r;++t)i[t].clearSelection(n);return this},getAreas:u,getMarkers:u,clearAreaSelection:u,clearMarkerSelection:u,center:function(n){var t=this;return n===i?t._projection.getCenter():(t._projection.setCenter(n),t)},zoomFactor:function(n){var t=this;return n===i?t._projection.getZoom():(t._projection.setZoom(n),t)},viewport:function(n){var t=this;return n===i?t._projection.getViewport():(t._projection.setViewport(n),t)},convertCoordinates:function(n){return n=n&&n.length?n:[arguments[0],arguments[1]],this._projection.fromScreenPoint(n)}});o("dxVectorMap",n.viz.map,y),n.viz.map.sources={}})(DevExpress,jQuery),function(n,t){var r={_initEvents:function(){for(var i=this._eventNames,r=i.length,u=this._events={},n=0;n<r;++n)u[i[n]]=t.Callbacks()},_disposeEvents:function(){var n=this._events,t;for(t in n)n[t].empty();this._events=null},on:function(n){function r(){for(t in n)i[t].remove(n[t])}var i=this._events,t;for(t in n)i[t].add(n[t]);return r},_fire:function(n,t){this._events[n].fire(t)}};n.viz.map.makeEventEmitter=function(n){var i=n.prototype,t;for(t in r)i[t]=r[t]}}(DevExpress,jQuery),function(n,t,i){function k(n,t){return r(n-t)<1e-8}function rt(n,t){return k(n[0],t[0])&&k(n[1],t[1])}function h(n,t,i,r){var u=p(n);return isFinite(u)?e(o(u,t),i):r}function d(n,t,i,r){return[h(n[0],t[0],i[0],r[0]),h(n[1],t[1],i[1],r[1])]}function ut(n){return n instanceof u&&n||f.get(n)||f.get(ht)}function c(n){var t=this;t._initEvents(),t._params=n,t._engine=ut(),t._center=t._engine.center(),t._adjustCenter()}function l(n,t,i,u){var f=(i+u)/2;return r(n-f)>r(t-f)?n:t}function a(n,t,i,u){var f=(i+u)/2;return r(n-f)<r(t-f)?n:t}function ct(n,t,i){var u=n([i[0],i[3]]),f=n([i[0],i[1]]),e=n([i[2],i[3]]),s=n([i[2],i[1]]),h=a(u[0],f[0],e[0],s[0]),c=a(e[0],s[0],u[0],f[0]),l=a(u[1],e[1],f[1],s[1]),v=a(f[1],s[1],u[1],e[1]);return[2/o(r(h-c),r(l-v)),t([(h+c)/2,(l+v)/2])]}function u(n,i){var r=this,e=n.aspectRatio>0?p(n.aspectRatio):1,o=at(n.to),u=n.from?vt(n.from):v(it),s=u([0,0]),f=et([u([-1,0])[0],u([0,1])[1]],[u([1,0])[0],u([0,-1])[1]]);r.project=o,r.unproject=u,r.original=v(i||r),r.source=function(){return t.extend({},n)},r.isinv=v(!!n.from),r.ar=v(e),r.center=g(s),r.min=g(f.min),r.max=g(f.max)}function lt(n){return n instanceof u}function ft(n){return[n[0],-n[1]]}function at(n){return function(t){return ft(n(t))}}function vt(n){return function(t){return n(ft(t))}}function v(n){return function(){return n}}function g(n){return function(){return n.slice()}}function f(n){return n&&n.to?new u(n):null}function et(n,t){return{min:[e(n[0],t[0]),e(n[1],t[1])],max:[o(n[0],t[0]),o(n[1],t[1])]}}function yt(n,t,i,r,u){var e=(i[0]+r[0])/2-u/2,o=(i[1]+r[1])/2-u/2,f=2/u;return{to:function(t){var i=n(t);return[-1+(i[0]-e)*f,-1+(i[1]-o)*f]},from:function(n){var i=[e+(n[0]+1)/f,o+(n[1]+1)/f];return t(i)}}}var p=Number,e=Math.min,o=Math.max,r=Math.abs,s=Math.round,w=Math.log,ot=Math.pow,st=2/Math.LN2,nt=1/648e4,b=1,tt=256,it=[NaN,NaN],ht="mercator",y;c.prototype={constructor:c,_minZoom:b,_maxZoom:tt,_zoom:b,_center:it,_canvas:{},_scale:[],dispose:function(){this._disposeEvents()},setEngine:function(n){var t=this,i=ut(n);t._engine!==i&&(t._engine=i,t._fire("engine"),t._changeCenter(i.center())&&t._triggerCenterChanged(),t._changeZoom(t._minZoom)&&t._triggerZoomChanged(),t._adjustCenter(),t._setupScreen())},setBounds:function(n){n!==i&&this.setEngine(this._engine.original().bounds(n))},_setupScreen:function(){var n=this,t=n._canvas,i=t.width,r=t.height,u=n._engine.ar();n._x0=t.left+i/2,n._y0=t.top+r/2,i/r<=u?(n._xradius=i/2,n._yradius=i/2/u):(n._xradius=r/2*u,n._yradius=r/2),n._fire("screen")},setSize:function(n){var t=this;t._canvas=n,t._setupScreen()},_toScreen:function(n){return[this._x0+this._xradius*n[0],this._y0+this._yradius*n[1]]},_fromScreen:function(n){return[(n[0]-this._x0)/this._xradius,(n[1]-this._y0)/this._yradius]},_toTransformed:function(n){return[n[0]*this._zoom+this._dxcenter,n[1]*this._zoom+this._dycenter]},_toTransformedFast:function(n){return[n[0]*this._zoom,n[1]*this._zoom]},_fromTransformed:function(n){return[(n[0]-this._dxcenter)/this._zoom,(n[1]-this._dycenter)/this._zoom]},_adjustCenter:function(){var n=this,t=n._engine.project(n._center);n._dxcenter=-t[0]*n._zoom||0,n._dycenter=-t[1]*n._zoom||0},project:function(n){return this._engine.project(n)},transform:function(n){return this._toScreen(this._toTransformedFast(n))},isInvertible:function(){return this._engine.isinv()},getSquareSize:function(n){return[n[0]*this._zoom*this._xradius,n[1]*this._zoom*this._yradius]},getZoom:function(){return this._zoom},_changeZoom:function(n){var t=this,r=t._zoom,u=t._zoom=h(n,t._minZoom,t._maxZoom,t._minZoom),i=!k(r,u);return i&&(t._adjustCenter(),t._fire("zoom")),i},setZoom:function(n){this._engine.isinv()&&this._changeZoom(n)&&this._triggerZoomChanged()},getScaledZoom:function(){return s((this._scale.length-1)*w(this._zoom)/w(this._maxZoom))},setScaledZoom:function(n){this.setZoom(this._scale[s(n)])},changeScaledZoom:function(n){this.setZoom(this._scale[o(e(s(this.getScaledZoom()+n),this._scale.length-1),0)])},getZoomScalePartition:function(){return this._scale.length-1},_setupScaling:function(){var n=this,t=s(st*w(n._maxZoom)),r,i,u=1;for(t=t>4?t:4,r=ot(n._maxZoom,1/t),i=n._minZoom,n._scale=[i];u<=t;++u)n._scale.push(i*=r)},setMaxZoom:function(n){var t=this;t._minZoom=b,t._maxZoom=h(n,t._minZoom,p.MAX_VALUE,tt),t._setupScaling(),t._zoom>t._maxZoom&&t.setZoom(t._maxZoom),t._fire("max-zoom")},getCenter:function(){return this._center.slice()},setCenter:function(n){this._engine.isinv()&&this._changeCenter(n||[])&&this._triggerCenterChanged()},_changeCenter:function(n){var t=this,i=t._engine,u=t._center,f=t._center=d(n,i.min(),i.max(),i.center()),r=!rt(u,f);return r&&(t._adjustCenter(),t._fire("center")),r},_triggerCenterChanged:function(){this._params.centerChanged(this.getCenter())},_triggerZoomChanged:function(){this._params.zoomChanged(this.getZoom())},setCenterByPoint:function(n,t){var i=this,r=i._engine.project(n),u=i._fromScreen(t);i.setCenter(i._engine.unproject([-u[0]/i._zoom+r[0],-u[1]/i._zoom+r[1]]))},beginMoveCenter:function(){this._engine.isinv()&&(this._moveCenter=this._center)},endMoveCenter:function(){var n=this;n._moveCenter&&(rt(n._moveCenter,n._center)||n._triggerCenterChanged(),n._moveCenter=null)},moveCenter:function(n){var t=this,i,r;t._moveCenter&&(i=t._toScreen(t._toTransformed(t._engine.project(t._center))),r=t._engine.unproject(t._fromTransformed(t._fromScreen([i[0]+n[0],i[1]+n[1]]))),t._changeCenter(r))},getViewport:function(){var n=this,t=n._engine.unproject,i=t(n._fromTransformed([-1,-1])),r=t(n._fromTransformed([-1,1])),u=t(n._fromTransformed([1,-1])),f=t(n._fromTransformed([1,1])),e=et([l(i[0],r[0],u[0],f[0]),l(i[1],u[1],r[1],f[1])],[l(u[0],f[0],i[0],r[0]),l(r[1],f[1],i[1],u[1])]);return[].concat(e.min,e.max)},setViewport:function(n){var t=this._engine,i=n?ct(t.project,t.unproject,n):[this._minZoom,t.center()];this.setZoom(i[0]),this.setCenter(i[1])},getTransform:function(){return{translateX:this._dxcenter*this._xradius,translateY:this._dycenter*this._yradius}},fromScreenPoint:function(n){return this._engine.unproject(this._fromTransformed(this._fromScreen(n)))},_eventNames:["engine","screen","center","zoom","max-zoom"]},n.viz.map.makeEventEmitter(c),u.prototype.aspectRatio=function(n){var t=this.source();return t.aspectRatio=n,new u(t,this)},u.prototype.bounds=function(n){n=n||[];var i=this.source(),s=this.min(),h=this.max(),f=i.to(d([n[0],n[1]],s,h,s)),o=i.to(d([n[2],n[3]],s,h,h)),c=e(r(o[0]-f[0])>nt?r(o[0]-f[0]):2,r(o[1]-f[1])>nt?r(o[1]-f[1]):2);return c<2&&t.extend(i,yt(i.to,i.from,f,o,c)),new u(i,this)},y={},f.get=function(n){return y[n]||null},f.add=function(n,t){return!y[n]&&lt(t)&&(y[n]=t),f},n.viz.map.Projection=c,n.viz.map.projection=f}(DevExpress,jQuery),function(n){function s(n,t){return y(v(n,+t),-t)}var r=n.viz.map.projection,v=Math.min,y=Math.max,p=Math.sin,w=Math.asin,c=Math.tan,e=Math.atan,o=Math.exp,l=Math.log,i=Math.PI,a=i/4,u=180,h=90,f=i/180,b=(2*e(o(i))-i/2)/f,k=(2.5*e(o(.8*i))-.625*i)/f;r.add("mercator",r({aspectRatio:1,to:function(n){return[n[0]/u,l(c(a+s(n[1],b)*f/2))/i]},from:function(n){return[n[0]*u,(2*e(o(n[1]*i))-i/2)/f]}})),r.add("equirectangular",r({aspectRatio:2,to:function(n){return[n[0]/u,n[1]/h]},from:function(n){return[n[0]*u,n[1]*h]}})),r.add("lambert",r({aspectRatio:2,to:function(n){return[n[0]/u,p(s(n[1],h)*f)]},from:function(n){return[n[0]*u,w(s(n[1],1))/f]}})),r.add("miller",r({aspectRatio:1,to:function(n){return[n[0]/u,1.25*l(c(a+s(n[1],k)*f*.4))/i]},from:function(n){return[n[0]*u,(2.5*e(o(.8*n[1]*i))-.625*i)/f]}}))}(DevExpress),function(n){function g(n){var t=this;t._params=n,t._createElements(n.renderer,n.container,n.dataKey),n.layoutControl.addItem(t),t._subscribeToProjection(n.projection),t._subscribeToTracker(n.tracker),t._createCallbacks(n.projection,n.renderer)}function s(n){delete n._owner,n.update=function(){},n.finish=function(){}}function c(n,t){this._owner=n,this._command=t}function l(n,t,i){function e(){n._callbacks.move([r,u]),f=setTimeout(e,o)}this._command=t;var f=null,o=100,r=0,u=0;switch(this._command){case p:u=-10;break;case w:r=10;break;case b:u=10;break;case k:r=-10}this._stop=function(){return clearTimeout(f),n._callbacks.endMove(),this._stop=n=null,this},i=null,n._callbacks.beginMove(),e()}function a(n,t){function r(){n._adjustZoom(n._zoomFactor+f),i=setTimeout(r,u)}this._owner=n,this._command=t;var i=null,u=150,f=this._command===d?1:-1;this._stop=function(){return clearTimeout(i),this._stop=n=null,this},r()}function v(n,t,i){this._owner=n,this._zoomFactor=n._zoomFactor,this._pos=i.y}var f=Math,nt=f.min,tt=f.max,h=f.round,it=f.floor,et=f.sqrt,y=n.viz.utils.parseScalar,ot=n.viz.utils.enumParser(["left","center","right"]),st=n.viz.utils.enumParser(["top","bottom"]),rt="command-reset",p="command-move-up",w="command-move-right",b="command-move-down",k="command-move-left",d="command-zoom-in",ut="command-zoom-out",ht="command-zoom-drag-line",ft="command-zoom-drag",i="control-bar",e=1,u=2,o={bigCircleSize:58,smallCircleSize:28,buttonSize:10,arrowButtonOffset:20,incdecButtonSize:11,incButtonOffset:66,decButtonOffset:227,sliderLineStartOffset:88.5,sliderLineEndOffset:205.5,sliderLength:20,sliderWidth:8,trackerGap:4},ct=30.5,lt=30.5,at=61,vt=274,r={};r[rt]=c,r[p]=r[w]=r[b]=r[k]=l,r[d]=r[ut]=a,r[ft]=v,g.prototype={constructor:g,_flags:0,dispose:function(){var n=this;n._params.layoutControl.removeItem(n),n._root.linkRemove().linkOff(),n._offProjection(),n._offTracker(),n._params=n._root=n._offProjection=n._offTracker=n._callbacks=null},_subscribeToProjection:function(n){function i(){t._adjustZoom(n.getScaledZoom())}var t=this;t._offProjection=n.on({engine:function(){t._update()},zoom:i,"max-zoom":function(){t._zoomPartition=n.getZoomScalePartition(),t._sliderUnitLength=t._sliderLineLength/t._zoomPartition,i()}})},_subscribeToTracker:function(n){var r=this,t=!1;r._offTracker=n.on({start:function(n){t=n.data.name===i,t&&r._processStart(n.data.index,n)},move:function(n){t&&r._processMove(n.data.index,n)},end:function(){t&&(r._processEnd(),t=!1)}})},_createCallbacks:function(n){var i=this;i._callbacks={reset:function(t,i){t&&n.setCenter(null),i&&n.setZoom(null)},beginMove:function(){n.beginMoveCenter()},endMove:function(){n.endMoveCenter()},move:function(t){n.moveCenter(t)},zoom:function(t){n.setScaledZoom(t)}}},_createElements:function(n,t,i){var r=this,u,f;r._root=n.g().attr({"class":"dxm-control-bar"}).linkOn(t,"control-bar"),u=r._buttonsGroup=n.g().attr({"class":"dxm-control-buttons"}).append(r._root),f=n.g().attr({stroke:"none","stroke-width":0,fill:"#000000",opacity:.0001}).css({cursor:"pointer"}).append(r._root),r._createButtons(n,i,u),r._createTrackers(n,i,f)},_createButtons:function(n,t,i){var l=this,r=o,u=r.buttonSize/2,f=r.arrowButtonOffset-u,s=r.arrowButtonOffset,e=r.incdecButtonSize/2,h={"stroke-linecap":"square",fill:"none"},c="line";n.circle(0,0,r.bigCircleSize/2).append(i),n.circle(0,0,u).attr({fill:"none"}).append(i),n.path([-u,-f,0,-s,u,-f],c).attr(h).append(i),n.path([f,-u,s,0,f,u],c).attr(h).append(i),n.path([u,f,0,s,-u,f],c).attr(h).append(i),n.path([-f,u,-s,0,-f,-u],c).attr(h).append(i),n.circle(0,r.incButtonOffset,r.smallCircleSize/2).append(i),n.path([[-e,r.incButtonOffset,e,r.incButtonOffset],[0,r.incButtonOffset-e,0,r.incButtonOffset+e]],"area").append(i),n.circle(0,r.decButtonOffset,r.smallCircleSize/2).append(i),n.path([-e,r.decButtonOffset,e,r.decButtonOffset],"area").append(i),l._zoomLine=n.path([],"line").append(i),l._zoomDrag=n.rect(it(-r.sliderLength/2),it(r.sliderLineEndOffset-r.sliderWidth/2),r.sliderLength,r.sliderWidth).append(i),l._sliderLineLength=r.sliderLineEndOffset-r.sliderLineStartOffset},_createTrackers:function(n,t,r){var u=o,f=h((u.arrowButtonOffset-u.trackerGap)/2),s=u.arrowButtonOffset-f,c=h(et(u.bigCircleSize*u.bigCircleSize/4-f*f)),e=c-s;n.rect(-f,-f,f*2,f*2).data(t,{index:rt,name:i}).append(r),n.rect(-f,-c,f*2,e).data(t,{index:p,name:i}).append(r),n.rect(s,-f,e,f*2).data(t,{index:w,name:i}).append(r),n.rect(-f,s,f*2,e).data(t,{index:b,name:i}).append(r),n.rect(-c,-f,e,f*2).data(t,{index:k,name:i}).append(r),n.circle(0,u.incButtonOffset,u.smallCircleSize/2).data(t,{index:d,name:i}).append(r),n.circle(0,u.decButtonOffset,u.smallCircleSize/2).data(t,{index:ut,name:i}).append(r),n.rect(-2,u.sliderLineStartOffset-2,4,u.sliderLineEndOffset-u.sliderLineStartOffset+4).css({cursor:"default"}).data(t,{index:ht,name:i}).append(r),this._zoomDragTracker=n.rect(-u.sliderLength/2,u.sliderLineEndOffset-u.sliderWidth/2,u.sliderLength,u.sliderWidth).data(t,{index:ft,name:i}).append(r)},resize:function(n){this._isActive&&this._root.attr({visibility:n!==null?null:"hidden"})},getLayoutOptions:function(){return this._isActive?this._layoutOptions:null},locate:function(n,t){this._root.attr({translateX:n+this._margin+ct,translateY:t+this._margin+lt})},_update:function(){var n=this;n._isActive=n._isEnabled&&n._flags&&n._params.projection.isInvertible(),n._isActive?n._root.linkAppend():n._root.linkRemove(),n._processEnd(),n.updateLayout()},setInteraction:function(n){var t=this;y(n.centeringEnabled,!0)?t._flags|=e:t._flags&=~e,y(n.zoomingEnabled,!0)?t._flags|=u:t._flags&=~u,t._update()},setOptions:function(n){var t=this;t._isEnabled=!!y(n.enabled,!0),t._margin=n.margin||0,t._layoutOptions={width:2*t._margin+at,height:2*t._margin+vt,horizontalAlignment:ot(n.horizontalAlignment,"left"),verticalAlignment:st(n.verticalAlignment,"top")},t._buttonsGroup.attr({"stroke-width":n.borderWidth,stroke:n.borderColor,fill:n.color,"fill-opacity":n.opacity}),t._update()},_adjustZoom:function(n){var t=this,i,r,f=o.sliderLineStartOffset,u=o.sliderLineEndOffset,e=o.sliderWidth;t._zoomFactor=tt(nt(h(n),t._zoomPartition),0),i={translateY:-h(t._zoomFactor*t._sliderUnitLength)},r=u-e/2+i.translateY,t._zoomLine.attr({points:[[0,f,0,tt(f,r)],[0,nt(u,r+e),0,u]]}),t._zoomDrag.attr(i),t._zoomDragTracker.attr(i)},_applyZoom:function(){this._callbacks.zoom(this._zoomFactor)},_processStart:function(n,t){var i;this._isActive&&(i=r[n],this._command=i&&i.flags&this._flags?new i(this,n,t):null)},_processMove:function(n,t){this._command&&this._command.update(n,t)},_processEnd:function(){this._command&&this._command.finish(),this._command=null}},c.flags=e|u,c.prototype.update=function(n){n!==this._command&&s(this)},c.prototype.finish=function(){var n=this._owner._flags;this._owner._callbacks.reset(!!(n&e),!!(n&u)),s(this)},l.flags=e,l.prototype.update=function(n){this._command!==n&&this.finish()},l.prototype.finish=function(){s(this._stop())},a.flags=u,a.prototype.update=function(n){this._command!==n&&this.finish()},a.prototype.finish=function(){this._owner._applyZoom(),s(this._stop())},v.flags=u,v.prototype.update=function(n,t){var i=this._owner;i._adjustZoom(this._zoomFactor+i._zoomPartition*(this._pos-t.y)/i._sliderLineLength)},v.prototype.finish=function(){this._owner._applyZoom(),s(this)},n.viz.map.ControlBar=g}(DevExpress),function(n){function i(n){var t=this;t._projection=n.projection,t._renderer=n.renderer,t._x=t._y=0,t._subscribeToTracker(n.tracker)}var r=Math.log,u=Math.LN2;i.prototype={constructor:i,dispose:function(){this._offTracker(),this._offTracker=null},_subscribeToTracker:function(n){var t=this,i=!1;t._offTracker=n.on({start:function(n){i=n.data.name!=="control-bar",i&&t._processStart(n)},move:function(n){i&&t._processMove(n)},end:function(){i&&t._processEnd()},zoom:function(n){t._processZoom(n)}})},setInteraction:function(n){this._processEnd(),this._centeringEnabled=n.centeringEnabled,this._zoomingEnabled=n.zoomingEnabled},_processStart:function(n){this._centeringEnabled&&(this._x=n.x,this._y=n.y,this._projection.beginMoveCenter())},_processMove:function(n){var t=this;t._centeringEnabled&&(t._renderer.root.attr({cursor:"move"}),t._projection.moveCenter([t._x-n.x,t._y-n.y]),t._x=n.x,t._y=n.y)},_processEnd:function(){this._centeringEnabled&&(this._renderer.root.attr({cursor:"default"}),this._projection.endMoveCenter())},_processZoom:function(n){var t=this,f,i,e;t._zoomingEnabled&&(n.delta?f=n.delta:n.ratio&&(f=r(n.ratio)/u),t._centeringEnabled&&(i=t._renderer.getRootOffset(),i=[n.x-i.left,n.y-i.top],e=t._projection.fromScreenPoint(i)),t._projection.changeScaledZoom(f),t._centeringEnabled&&t._projection.setCenterByPoint(e,i))}},n.viz.map.GestureHandler=i}(DevExpress),function(n,t,i){function h(n){var t=this;t._root=n.root,t._createEventHandlers(n.dataKey),t._createProjectionHandlers(n.projection),t._initEvents(),t._focus=new et(function(n,i){t._fire(n,i)}),t._attachHandlers()}function ot(n,t,i,r){return ht((n-i)*(n-i)+(t-r)*(t-r))}function r(n){var t=n.originalEvent.type,i=n.originalEvent.pointerType;return/^touch/.test(t)||/^MSPointer/.test(t)&&i!==4||/^pointer/.test(t)&&i!=="mouse"}function c(n,t){for(var i=0,u=n.length,r;i<u;++i)if(n[i]){r=t[i];break}return o(r||t[i],s)}function ti(){var n=[navigator.pointerEnabled,navigator.msPointerEnabled,"ontouchstart"in window];f={start:c(n,["pointerdown","MSPointerDown","touchstart mousedown","mousedown"]),move:c(n,["pointermove","MSPointerMove","touchmove mousemove","mousemove"]),end:c(n,["pointerup","MSPointerUp","touchend mouseup","mouseup"]),wheel:c([],["mousewheel DOMMouseScroll"])}}function e(n){var t=n.originalEvent,i=t.touches&&t.touches[0]||{};return{x:i.pageX||t.pageX||n.pageX,y:i.pageY||t.pageY||n.pageY}}function st(n){return n.originalEvent.pointerId}function l(n,t){var r=n.originalEvent;return r=r.pointerId!==i?r.pointerId===t?r:null:r.touches[t],r?{x:r.pageX||n.pageX,y:r.pageY||n.pageY}:null}function ii(n,t){if(n===0)return 0;var i=u(n),r=b(n/i);return t.dir&&r!==t.dir?0:(t.dir=r,i=i<.1?0:i<1?1:i>4?4:b(i),r*i)}var a=Math,u=a.abs,ht=a.sqrt,b=a.round,ct=n.require("/ui/events/ui.events.utils"),o=ct.addNamespace,k=n.viz.utils.parseScalar,v=t.now,s=n.viz.map.dxVectorMap.publicName(),f={},et;ti();var d="start",g="move",nt="end",y="zoom",tt="hover-on",it="hover-off",rt="click",p="focus-on",ut="focus-move",w="focus-off",lt=500,at=5,vt=20,yt=5,pt=10,wt=300,bt=300,kt=300,dt=400,ft=5,gt=50,ni=300;h.prototype={constructor:h,dispose:function(){var n=this;n._detachHandlers(),n._disposeEvents(),n._focus.dispose(),n._root=n._focus=n._docHandlers=n._rootHandlers=null},_eventNames:[d,g,nt,y,rt,tt,it,p,w,ut],_startClick:function(n,t){if(t){var i=e(n);this._clickState={x:i.x,y:i.y,threshold:r(n)?vt:at,time:v()}}},_endClick:function(n,t){var i=this._clickState,f,r;i&&(v()-i.time<=lt&&(f=i.threshold,r=e(n),u(r.x-i.x)<=f&&u(r.y-i.y)<=f&&this._fire(rt,{data:t,x:r.x,y:r.y,$event:n})),this._clickState=null)},_startDrag:function(n,t){if(t){var r=e(n),i=this._dragState={x:r.x,y:r.y,data:t};this._fire(d,{x:i.x,y:i.y,data:i.data})}},_moveDrag:function(n,t){var i=this._dragState,f,o;i&&(f=e(n),o=r(n)?pt:yt,(i.active||u(f.x-i.x)>o||u(f.y-i.y)>o)&&(i.x=f.x,i.y=f.y,i.active=!0,i.data=t||{},this._fire(g,{x:i.x,y:i.y,data:i.data})))},_endDrag:function(){var n=this._dragState;n&&(this._dragState=null,this._fire(nt,{x:n.x,y:n.y,data:n.data}))},_wheelZoom:function(n,t){if(t){var o=this,i=o._wheelLock,r=v(),u,f;r-i.time<=gt||(r-i.dirTime>ni&&(i.dir=0),u=ii(n.originalEvent.wheelDelta/120||n.originalEvent.detail/-3||0,i),u!==0)&&(f=e(n),o._fire(y,{delta:u,x:f.x,y:f.y}),i.time=i.dirTime=r)}},_startZoom:function(n,t){if(r(n)&&t){var u=this._zoomState=this._zoomState||{},f,e;u.pointer1&&u.pointer2||(u.pointer1===i&&(u.pointer1=st(n)||0,f=l(n,u.pointer1),u.x1=u.x1_0=f.x,u.y1=u.y1_0=f.y),u.pointer2===i&&(e=st(n)||1,e!==u.pointer1&&(f=l(n,e),f&&(u.x2=u.x2_0=f.x,u.y2=u.y2_0=f.y,u.pointer2=e,u.ready=!0,this._endDrag()))))}},_moveZoom:function(n){var t=this._zoomState,u;t&&r(n)&&(t.pointer1!==i&&(u=l(n,t.pointer1),u&&(t.x1=u.x,t.y1=u.y)),t.pointer2!==i&&(u=l(n,t.pointer2),u&&(t.x2=u.x,t.y2=u.y)))},_endZoom:function(n){var t=this._zoomState,i,u;t&&r(n)&&(t.ready&&(i=ot(t.x1_0,t.y1_0,t.x2_0,t.y2_0),u=ot(t.x1,t.y1,t.x2,t.y2),this._fire(y,{ratio:u/i,x:(t.x1_0+t.x2_0)/2,y:(t.y1_0+t.y2_0)/2})),this._zoomState=null)},_startHover:function(n,t){this._doHover(n,t,!0)},_moveHover:function(n,t){this._doHover(n,t,!1)},_doHover:function(n,t,i){var u=this;if(u._dragState&&u._dragState.active||u._zoomState&&u._zoomState.ready){u._cancelHover();return}r(n)!==i||u._hoverTarget===n.target||u._hoverState&&u._hoverState.data===t||(u._cancelHover(),t&&(u._hoverState={data:t},u._fire(tt,{data:t})),u._hoverTarget=n.target)},_cancelHover:function(){var n=this._hoverState;this._hoverState=this._hoverTarget=null,n&&this._fire(it,{data:n.data})},_startFocus:function(n,t){this._doFocus(n,t,!0)},_moveFocus:function(n,t){this._doFocus(n,t,!1)},_doFocus:function(n,t,i){var u=this;if(u._dragState&&u._dragState.active||u._zoomState&&u._zoomState.ready){u._cancelFocus();return}r(n)===i&&(u._focus.turnOff(i?dt:bt),t&&u._focus.turnOn(t,e(n),i?kt:wt,i))},_endFocus:function(n){r(n)&&this._focus.cancelOn()},_cancelFocus:function(){this._focus.cancel()},_createEventHandlers:function(n){function i(t){var i=t.target;return(i.tagName==="tspan"?i.parentNode:i)[n]}var t=this;t._docHandlers={},t._rootHandlers={},t._rootHandlers[f.start]=t._docHandlers[f.start]=function(n){var f=r(n),u=i(n);(!f||t._isTouchEnabled)&&(u&&(n.preventDefault(),n.stopPropagation()),t._startClick(n,u),t._startDrag(n,u),t._startZoom(n,u),t._startHover(n,u),t._startFocus(n,u))},t._docHandlers[f.move]=function(n){var f=r(n),u=i(n);(!f||t._isTouchEnabled)&&(t._moveDrag(n,u),t._moveZoom(n,u),t._moveHover(n,u),t._moveFocus(n,u))},t._docHandlers[f.end]=function(n){var f=r(n),u=i(n);(!f||t._isTouchEnabled)&&(t._endClick(n,u),t._endDrag(n,u),t._endZoom(n,u),t._endFocus(n,u))},t._rootHandlers[f.wheel]=function(n){if(t._cancelFocus(),t._isWheelEnabled){var r=i(n);r&&(n.preventDefault(),n.stopPropagation(),t._wheelZoom(n,r))}},t._wheelLock={dir:0}},_createProjectionHandlers:function(n){function t(){i._cancelFocus()}var i=this;n.on({center:t,zoom:t})},reset:function(){var n=this;n._clickState=null,n._endDrag(),n._cancelHover(),n._cancelFocus()},setOptions:function(n){var t=this;t.reset(),t._detachHandlers(),t._isTouchEnabled=!!k(n.touchEnabled,!0),t._isWheelEnabled=!!k(n.wheelEnabled,!0),t._attachHandlers()},_detachHandlers:function(){var n=this;n._isTouchEnabled&&n._root.css({"touch-action":"","-ms-touch-action":"","-webkit-user-select":""}).off(o("MSHoldVisual",s)).off(o("contextmenu",s)),t(document).off(n._docHandlers),n._root.off(n._rootHandlers)},_attachHandlers:function(){var n=this;if(n._isTouchEnabled)n._root.css({"touch-action":"none","-ms-touch-action":"none","-webkit-user-select":"none"}).on(o("MSHoldVisual",s),function(n){n.preventDefault()}).on(o("contextmenu",s),function(n){r(n)&&n.preventDefault()});t(document).on(n._docHandlers);n._root.on(n._rootHandlers)}},et=function(n){var i=this,r=null,f=null,h=!1,t=null,e=null,o,s;i.dispose=function(){clearTimeout(t),clearTimeout(e),i.turnOn=i.turnOff=i.cancel=i.cancelOn=i.dispose=i=n=r=f=t=e=null},i.turnOn=function(i,c,l,a){function v(n){h=!n,n&&(r=f,clearTimeout(e),e=null)}i===f&&h||(h=!1,f=i,r?(o=c.x,s=c.y,clearTimeout(t),t=setTimeout(function(){t=null,f===r?(n(ut,{data:f,x:o,y:s}),v(!0)):n(p,{data:f,x:o,y:s,done:v})},a?l:0)):(!t||u(c.x-o)>ft||u(c.y-s)>ft||a)&&(o=c.x,s=c.y,clearTimeout(t),t=setTimeout(function(){t=null,n(p,{data:f,x:o,y:s,done:v})},l)))},i.turnOff=function(i){clearTimeout(t),t=null,f=null,r&&!h&&(e=e||setTimeout(function(){e=null,n(w,{data:r}),r=null},i))},i.cancel=function(){clearTimeout(t),clearTimeout(e),r&&n(w,{data:r}),r=f=t=e=null},i.cancelOn=function(){clearTimeout(t),t=null}},n.viz.map.makeEventEmitter(h),n.viz.map.Tracker=h}(DevExpress,jQuery),function(n){n.viz.map.ThemeManager=n.viz.BaseThemeManager.inherit({_themeSection:"map",_fontFields:["layer:area.label.font","layer:marker:dot.label.font","layer:marker:bubble.label.font","layer:marker:pie.label.font","layer:marker:image.label.font","tooltip.font","legend.font","title.font","title.subtitle.font","loadingIndicator.font"]})}(DevExpress,jQuery),function(n){function i(){this._store={}}i.prototype={constructor:i,dispose:function(){return this._store=null,this},_get:function(n,t){var i=this._store[n]||(this._store[n]={});return i[t]||(i[t]={})},set:function(n,t,i){var r=this._get(n,t);return r.data=i,r.callback&&r.callback(i),this},bind:function(n,t,i){var r=this._get(n,t);return r.callback=i,r.data&&i(r.data),this},unbind:function(n,t){var i=this._get(n,t);return i.data=i.callback=null,this}},n.viz.map.DataExchanger=i}(DevExpress),function(n,t){function l(n){var t;return t=typeof n=="string"?c[n.toLowerCase()]||o:{category:n.layer,name:n.grouping}}function u(n){var t=this;t._params=n,t._root=n.renderer.g().attr({"class":"dxm-legend"}).linkOn(n.container,{name:"legend",after:"legend-base"}).linkAppend(),n.layoutControl.addItem(t),r.call(t,{renderer:n.renderer,group:t._root,backgroundClass:null,itemsGroupClass:null,textField:"text",getFormatObject:function(n){return n}}),t._onDataChanged=function(n){t._updateData(n)}}function a(n,t,i){for(var e=t.length,f=[],u,r=0;r<e;++r)f[r]=u={start:n[r],end:n[r+1],index:r},u[i]=t[r],u.states={normal:{fill:u.color}};return f}function f(n){this._params=n,this._items=[],n.container.virtualLink("legend-base")}var s=n.viz,e=t.extend,h=t.each,r=s.Legend,c={areacolorgroups:{category:"areas",name:"color"},markercolorgroups:{category:"markers",name:"color"},markersizegroups:{category:"markers",name:"size"}},o={category:"UNKNOWN",name:"UNKNOWN"};u.prototype=e(n.require("/utils/utils.object").clone(r.prototype),{constructor:u,dispose:function(){var n=this;return n._params.layoutControl.removeItem(n),n._unbindData(),n._root.linkRemove().linkOff(),n._params=n._root=n._onDataChanged=null,r.prototype.dispose.apply(n,arguments)},resize:function(n){this._params.notifyDirty(),n===null?this.erase():this.draw(n.width,n.height),this._params.notifyReady()},locate:r.prototype.shift,_updateData:function(n){this.update(n?a(n.partition,n.values,this._dataName):[],this._options),this.updateLayout()},_unbindData:function(){this._dataCategory&&this._params.dataExchanger.unbind(this._dataCategory,this._dataName)},_bindData:function(n){this._params.dataExchanger.bind(this._dataCategory=n.category,this._dataName=n.name,this._onDataChanged)},setOptions:function(n){var t=this;return t.update(t._data,n),t._unbindData(),t._bindData(n.source&&l(n.source)||o),t.updateLayout(),t}}),f.prototype={constructor:f,dispose:function(){h(this._items,function(n,t){t.dispose()}),this._params=this._items=null},setOptions:function(n){for(var o=n&&n.length?n:[],i=this._items,f=o.length,r=this._params,s=r.themeManager.theme("legend"),t=i.length;t<f;++t)i[t]=new u(r);for(t=i.length-1;t>=f;--t)i[t].dispose(),i.splice(t,1);for(r.layoutControl.suspend(),t=0;t<f;++t)i[t].setOptions(e(!0,{},s,o[t]));r.layoutControl.resume()}},n.viz.map.LegendsControl=f}(DevExpress,jQuery),function(n,t){function a(n){return l[n.verticalAlignment]*3+c[n.horizontalAlignment]}function v(n,t){var h=(n.right-n.left)/3,p=(n.bottom-n.top)/2,f=n.left,e=u(f+h),o=u(f+h+h),v=n.right,s=n.top,i=u(s+p),c=n.bottom,y=[{rect:[f,s,e,i]},{rect:[e,s,o,i],center:!0},{rect:[o,s,v,i],horInv:!0},{rect:[f,i,e,c],verInv:!0},{rect:[e,i,o,c],center:!0,verInv:!0},{rect:[o,i,v,c],horInv:!0,verInv:!0}],l=[[],[],[],[],[],[]];return r(t,function(n,t){var i=t.getLayoutOptions();i&&l[a(i)].push({item:t,width:i.width,height:i.height})}),r(y,function(n,t){l[n].length?t.items=l[n]:(t.center?t.rect[0]=t.rect[2]=(t.rect[0]+t.rect[2])/2:t.rect[t.horInv?0:2]=t.rect[t.horInv?2:0],t.rect[t.verInv?1:3]=t.rect[t.verInv?3:1])}),y}function y(n){r([0,1,2,3,4,5],function(t,i){var r=n[i],u=n[(i+3)%6];r.items&&(u.items||(r.rect[1]=e(r.rect[1],u.rect[3]),r.rect[3]=f(r.rect[3],u.rect[1])))}),r([1,4],function(t,i){var r=n[i],e=n[i-1],o=n[i+1],u,f;r.items?e.items||o.items||(u=r.rect[0]-e.rect[2],f=o.rect[0]-r.rect[2],u>f?u/f>=2?(r.rect[0]-=u,r.right=!0):(r.rect[0]-=f,r.rect[2]+=f):f/u>=2?(r.rect[2]+=f,r.center=null):(r.rect[0]-=u,r.rect[2]+=u)):(e.items&&(e.rect[2]=(r.rect[0]+r.rect[2])/2),o.items&&(o.rect[0]=(r.rect[0]+r.rect[2])/2))})}function s(n,t){var i=!1;return y(n),r(n,function(n,r){r.items&&(i=p(r,t)||i)}),i}function p(n,t){var i=n.rect,w=i[2]-i[0],b=i[3]-i[1],o=0,c=0,l=0,s=i[2],y=i[3],h=i[0],p=i[1],a=[],v=!1;return r(n.items,function(r,u){if(u.width>w||u.height>b||(o+u.width>w&&(c+=l,o=l=0),c+u.height>b))return a.push(null),v=!0,t||!1;l=f(l,u.height);var k=n.horInv?i[2]-u.width-o:i[0]+o,d=n.verInv?i[3]-u.height-c:i[1]+c;o+=u.width,s=e(s,k),y=e(y,d),h=f(h,k+u.width),p=f(p,d+u.height),a.push([k,d])}),(t||!v)&&(o=0,n.right?o=i[2]-i[0]-h+s:n.center&&(o=u((i[2]-i[0]-h+s)/2)),r(n.items,function(n,t){var i=a[n];i?t.item.locate(i[0]+o,i[1]):t.item.resize(null)}),n.rect=[s,y,h,p],n.items=null),v}function w(n,t){var i=v(n,t);s(i)&&s(i,!0)}function o(){var n=this;n._items=[],n._suspended=0,n._updateLayout=function(){n._update()}}var u=Math.round,e=Math.min,f=Math.max,r=t.each,h=t.inArray,c={left:0,center:1,right:2},l={top:0,bottom:1};o.prototype={constructor:o,dispose:function(){this._items=this._updateLayout=null},setSize:function(n){this._canvas=n,this._update()},suspend:function(){++this._suspended},resume:function(){--this._suspended==0&&this._update()},addItem:function(n){this._items.push(n),n.updateLayout=this._updateLayout},removeItem:function(n){this._items.splice(h(n,this._items),1),n.updateLayout=null},_update:function(){var n;this._suspended===0&&(n=this._canvas,r(this._items,function(t,i){i.resize(n)}),w({left:n.left,top:n.top,right:n.width+n.left,bottom:n.height+n.top},this._items))}},n.viz.map.LayoutControl=o}(DevExpress,jQuery),function(n,t,i){function wi(n){var t=rt(n);return t=t in ut?ut[t]:ut.single,t!==null&&(t={state:{},single:t}),t}function ft(){}function et(n){this.raw=n}function g(n){this.raw=n}function ot(n){return kt(n.features)}function bi(n){var t;return n&&(ot(n)?t=g:n.length===1&&n[0]&&ot(n[0])?(t=g,n=n[0]):kt(n)&&(t=et)),t=t||ft,new t(n)}function ki(n){return n?ot(n)?[n]:n:[]}function di(n,t,i){t.call(i,n)}function gi(n,t){for(var f=n.length,i,u,r=0;r<f;++r)i=n[r],u=t.call(i,i)||{},i.applySettings(u),u.isSelected&&i.selected(!0)}function nr(n,t,i){for(var e={areas:"area",markers:"marker"}[t],o=n.length,u,r=0;r<o;++r)n[r].proxy.type=e;if(e==="marker")for(r=0;r<o;++r)u=i.item(r),f(n[r].proxy,{text:u.text,value:u.value,values:u.values,url:u.url})}function gt(n){n.text.attr({visibility:n.size[0]/n.spaceSize[0]<d&&n.size[1]/n.spaceSize[1]<d?null:"hidden"})}function ni(n){n.text.attr({visibility:n.size[0]/n.spaceSize[0]<d||n.size[1]/n.spaceSize[1]<d?null:"hidden"})}function p(n,t,i){return n.attribute(t)||n[i]}function tr(n){var t=ti[n.type],i=n.coordinates;return t||(t=typeof i[0]=="number"?y:typeof i[0][0]=="number"?h:v),t}function e(n,t,i,r){n[r].attr(t[r][i])}function ir(n,t){return n.project(t)}function ri(n,t){for(var r=[],u=r.length=t.length,i=0;i<u;++i)r[i]=n.project(t[i]);return r}function rr(n,t){return[ri(n,t)]}function ht(n,t){for(var r=[],u=r.length=t.length,i=0;i<u;++i)r[i]=ri(n,t[i]);return r}function ur(n,t){for(var r=[],u=r.length=t.length,i=0;i<u;++i)r[i]=ht(n,t[i]);return vi.apply([],r)}function fr(n,t,i){var r=t.transform(i);n.root.attr({translateX:r[0],translateY:r[1]})}function er(n,t){var i=[],r,f=t.length,u,e=0;for(i.length=2*f,r=0;r<f;++r)u=n.transform(t[r]),i[e++]=u[0],i[e++]=u[1];return i}function ui(n,t,i){for(var u=[],f=u.length=i.length,r=0;r<f;++r)u[r]=er(t,i[r]);n.root.attr({points:u})}function or(n,t,i){var r=t.transform(i[0]);n.spaceSize=t.getSquareSize(i[1]),n.text.attr({translateX:r[0],translateY:r[1]}),gt(n)}function sr(n,t,i){var r=t.transform(i[0]);n.spaceSize=t.getSquareSize(i[1]),n.text.attr({translateX:r[0],translateY:r[1]}),ni(n)}function hr(n,t,r){var u=ct(n.settings,r);return t.text=t.text||r.text,cr(n.grouping,t,u),r.color===i&&r.paletteIndex>=0&&(u.color=u._colors[r.paletteIndex]),u}function cr(n,t,i){a(n,function(n,r){var u=fi(r.callback(t,r.field),r.partition);u>=0&&(i[n]=r.values[u])})}function fi(n,t){var r=0,i=t.length-1,f=-1,u;if(t[r]<=n&&n<=t[i])if(n===t[i])f=i-1;else{while(i-r>1)u=r+i>>1,n<t[u]?i=u:r=u;f=r}return f}function ei(n,t,i,r){n.params.eventTrigger(r,{target:t.proxy,state:i})}function ct(n,t){var i=f({},n,t);return i.label=f({},n.label,i.label),i.label.font=f({},n.label.font,i.label.font),i}function lr(n,t,i){var r=ct(i.theme("layer:"+n)||{label:{}},t),f,u,e;if(r.paletteSize>0){for(e=i.createGradientPalette(r.palette,r.paletteSize),u=0,f=[];u<r.paletteSize;++u)f.push(e.getColor(u));r._colors=f}return r}function ar(n,t){return n.attribute(t)}function oi(n){var t=n.name,i=n.params.dataExchanger;a(n.grouping,function(n){i.set(t,n,null)}),n.grouping={}}function vt(n,t,i){return i?n|=t:n&=~t,n}function yt(n,t){return!!(n&t)}function vr(n,t,i){var r={index:i,name:t,getElements:function(){return n.getProxies()},clearSelection:function(t){return n.clearSelection(t),r}};return r}function yr(n,t,i){var r={coordinates:function(){return t},attribute:function(n,t){return arguments.length>1?(i[n]=t,r):arguments.length>0?i[n]:i},selected:function(t,i){return arguments.length>0?(n.setSelected(t,i),r):n.isSelected()},applySettings:function(t){return n.update(t),r}};return r}function pr(n){for(var a=n.length,i,t=n[a-1],r,v=0,y=0,f=0,o=Infinity,s=-Infinity,h=Infinity,c=-Infinity,e=0;e<a;++e)i=t,t=n[e],r=i[0]*t[1]-t[0]*i[1],f+=r,v+=(i[0]+t[0])*r,y+=(i[1]+t[1])*r,o=l(o,t[0]),s=u(s,t[0]),h=l(h,t[1]),c=u(c,t[1]);return{area:hi(f)/2,center:[2*v/3/f-(o+s)/2,2*y/3/f-(h+c)/2]}}function wr(n){for(var v=n.length,r,t=n[0]||[],f=0,e=[0],s=t[0],h=t[0],c=t[1],a=t[1],o,i=1;i<v;++i)r=t,t=n[i],f+=it((r[0]-t[0])*(r[0]-t[0])+(r[1]-t[1])*(r[1]-t[1])),e[i]=f,s=l(s,t[0]),h=u(h,t[0]),c=l(c,t[1]),a=u(a,t[1]);return i=fi(f/2,e),r=n[i],t=n[i+1],o=(f/2-e[i])/(e[i+1]-e[i]),v?[[r[0]*(1-o)+t[0]*o,r[1]*(1-o)+t[1]*o],[h-s,a-c],f]:[]}function br(n){for(var f=n.length,i,t,u=0,r=0;r<f;++r)i=pr(n[r]),i.area>u&&(u=i.area,t=i);return t?[t.center,[it(t.area),it(t.area)]]:[[],[]]}function kr(n){for(var f=n.length,r=0,t,u,i=0;i<f;++i)t=wr(n[i]),t[2]>r&&(r=t[2],u=t);return u||[[],[]]}function pt(n){var t=this,i=n.renderer;t._params=n,t._layers=[],t._layerByName={},t._rect=[0,0,0,0],t._clip=i.clipRect(),t._background=i.rect().attr({"class":"dxm-background"}).data(n.dataKey,{name:"background"}).append(i.root),t._container=i.g().attr({"class":"dxm-layers",clipId:t._clip.id}).append(i.root).enableLinks(),t._subscribeToTracker(n.tracker,i,n.eventTrigger)}var r=Number,si=String,hi=Math.abs,ci=Math.round,l=Math.min,u=Math.max,it=Math.sqrt,wt=n.require("/utils/utils.common"),bt=wt.isFunction,kt=wt.isArray,li=n.viz.utils.parseScalar,ai=n.viz.utils.patchFontOptions,rt=n.viz.utils.normalizeEnum,o=t.noop,f=t.extend,a=t.each,vi=Array.prototype.concat,v="area",h="line",y="marker",yi=0,dt=1,k=2,pi=[0,1,2,2],d=1,ut={none:null,single:-1,multiple:NaN},ti,ii,st,s,w,c,lt,nt,at,b,tt;ft.prototype.count=function(){return 0},et.prototype={constructor:et,count:function(){return this.raw.length},item:function(n){return this.raw[n]},geometry:function(n){return{coordinates:n.coordinates}},attributes:function(n){return n.attributes}},g.prototype={constructor:g,count:function(){return this.raw.features.length},item:function(n){return this.raw.features[n]},geometry:function(n){return n.geometry},attributes:function(n){return n.properties}},ti={Point:y,MultiPoint:h,LineString:h,MultiLineString:h,Polygon:v,MultiPolygon:v},ii=function(n,t){var i=rt(n.type),u=rt(n.elementType),e,r=f({},st);return t.count()>0&&(e=t.geometry(t.item(0)),i=s[i]?i:tr(e),f(r,s[i]),r.fullType=r.type=i,w[i]&&f(r,w[i](e)),c[i]&&(u=c[i][u]?u:c[i]._default,f(r,c[i][u]),r.elementType=u,r.fullType+=":"+u)),r},st={setup:o,reset:o,arrange:o,updateGrouping:o},s={},s[v]={projectLabel:br,transform:ui,transformLabel:or,draw:function(n,t,i){t.root=n.renderer.path([],"area").data(n.dataKey,i)},refresh:o,getLabelOffset:function(n){return gt(n),[0,0]},getStyles:function(n){var t=n.color||null,i=n.borderColor||null,r=n.borderWidth||null,u=n.opacity||null;return{root:[{"class":"dxm-area",stroke:i,"stroke-width":r,fill:t,opacity:u},{"class":"dxm-area dxm-area-hovered",stroke:n.hoveredBorderColor||i,"stroke-width":n.hoveredBorderWidth||r,fill:n.hoveredColor||t,opacity:n.hoveredOpacity||u},{"class":"dxm-area dxm-area-selected",stroke:n.selectedBorderColor||i,"stroke-width":n.selectedBorderWidth||r,fill:n.selectedColor||t,opacity:n.selectedOpacity||u}]}},setState:function(n,t,i){e(n,t,i,"root")},hasLabelsGroup:!0,updateGrouping:function(n){nt(n)}},s[h]={projectLabel:kr,transform:ui,transformLabel:sr,draw:function(n,t,i){t.root=n.renderer.path([],"line").data(n.dataKey,i)},refresh:o,getLabelOffset:function(n){return ni(n),[0,0]},getStyles:function(n){var t=n.color||n.borderColor||null,i=n.borderWidth||null,r=n.opacity||null;return{root:[{"class":"dxm-line",stroke:t,"stroke-width":i,opacity:r},{"class":"dxm-line dxm-line-hovered",stroke:n.hoveredColor||n.hoveredBorderColor||t,"stroke-width":n.hoveredBorderWidth||i,opacity:n.hoveredOpacity||r},{"class":"dxm-line dxm-line-selected",stroke:n.selectedColor||n.selectedBorderColor||t,"stroke-width":n.selectedBorderWidth||i,opacity:n.selectedOpacity||r}]}},setState:function(n,t,i){e(n,t,i,"root")},hasLabelsGroup:!0,updateGrouping:function(n){nt(n)}},s[y]={project:ir,transform:fr,draw:function(n,t,i){t.root=n.renderer.g(),this._draw(n,t,i)},refresh:o,hasLabelsGroup:!1,getLabelOffset:function(n,t){return[ci((n.size[0]+u(t.size||0,0))/2)+2,0]},getStyles:function(n){var t={root:[{"class":"dxm-marker"},{"class":"dxm-marker dxm-marker-hovered"},{"class":"dxm-marker dxm-marker-selected"}]};return this._getStyles(t,n),t},setState:function(n,t,i){e(n,t,i,"root"),this._setState(n,t,i)},updateGrouping:function(n){nt(n),at(n)}},w={},w[v]=function(n){var t=n.coordinates;return{project:t[0]&&t[0][0]&&t[0][0][0]&&typeof t[0][0][0][0]=="number"?ur:ht}},w[h]=function(n){var t=n.coordinates;return{project:t[0]&&t[0][0]&&typeof t[0][0][0]=="number"?ht:rr}},c={},c[y]={_default:"dot",dot:{setup:function(n){n.filter=n.renderer.shadowFilter("-40%","-40%","180%","200%",0,1,1,"#000000",.2)},reset:function(n){n.filter.dispose(),n.filter=null},_draw:function(n,t,i){t.back=n.renderer.circle().sharp().data(n.dataKey,i).append(t.root),t.dot=n.renderer.circle().sharp().data(n.dataKey,i).append(t.root)},refresh:function(n,t,i,r,u){t.dot.attr({filter:u.shadow?n.filter.ref:null})},_getStyles:function(n,t){var i=t.size>0?r(t.size):0,c=i,l=i+(t.selectedStep>0?r(t.selectedStep):0),a=c+(t.backStep>0?r(t.backStep):0),v=l+(t.backStep>0?r(t.backStep):0),u=t.color||null,f=t.borderColor||null,e=t.borderWidth||null,o=t.opacity||null,s=t.backColor||null,h=t.backOpacity||null;n.dot=[{r:i/2,stroke:f,"stroke-width":e,fill:u,opacity:o},{r:c/2,stroke:t.hoveredBorderColor||f,"stroke-width":t.hoveredBorderWidth||e,fill:t.hoveredColor||u,opacity:t.hoveredOpacity||o},{r:l/2,stroke:t.selectedBorderColor||f,"stroke-width":t.selectedBorderWidth||e,fill:t.selectedColor||u,opacity:t.selectedOpacity||o}],n.back=[{r:i/2,stroke:"none","stroke-width":0,fill:s,opacity:h},{r:a/2,stroke:"none","stroke-width":0,fill:s,opacity:h},{r:v/2,stroke:"none","stroke-width":0,fill:s,opacity:h}]},_setState:function(n,t,i){e(n,t,i,"dot"),e(n,t,i,"back")}},bubble:{_draw:function(n,t,i){t.bubble=n.renderer.circle().sharp().data(n.dataKey,i).append(t.root)},refresh:function(n,t,i,r,u){t.bubble.attr({r:u.size/2})},_getStyles:function(n,t){var f=t.color||null,i=t.borderColor||null,r=t.borderWidth||null,u=t.opacity||null;n.bubble=[{stroke:i,"stroke-width":r,fill:f,opacity:u},{stroke:t.hoveredBorderColor||i,"stroke-width":t.hoveredBorderWidth||r,fill:t.hoveredColor||t.color,opacity:t.hoveredOpacity||u},{stroke:t.selectedBorderColor||i,"stroke-width":t.selectedBorderWidth||r,fill:t.selectedColor||t.color,opacity:t.selectedOpacity||u}]},_setState:function(n,t,i){e(n,t,i,"bubble")},arrange:function(n,t){var e=[],i,h=e.length=t.length,f=n.settings,y=f.dataField,o=f.minSize>0?r(f.minSize):0,w=f.maxSize>o?r(f.maxSize):o,s,c,a,v;if(!f.sizeGroups){for(i=0;i<h;++i)e[i]=u(p(t[i].proxy,y,"value")||0,0);for(s=l.apply(null,e),c=u.apply(null,e),a=c-s||1,v=w-o,i=0;i<h;++i)t[i]._settings.size=o+v*(e[i]-s)/a}},updateGrouping:function(n){var t=n.settings.dataField;s[y].updateGrouping(n),at(n,function(n){return p(n,t,"value")})}},pie:{_draw:function(n,t,i){t.pie=n.renderer.g().append(t.root),t.border=n.renderer.circle().sharp().data(n.dataKey,i).append(t.root)},refresh:function(n,t,i,u,f){for(var o=p(u,n.settings.dataField,"values")||[],c=o.length||0,v=f._colors,l=0,y=t.pie,w=n.renderer,b=n.dataKey,a=(f.size>0?r(f.size):0)/2,s=90,h=s,e=0;e<c;++e)l+=o[e]||0;for(e=0;e<c;++e)s=h,h+=(o[e]||0)/l*360,w.arc(0,0,0,a,s,h).attr({"stroke-linejoin":"round",fill:v[e]}).data(b,i).append(y);t.border.attr({r:a})},_getStyles:function(n,t){var i=t.opacity||null,r=t.borderColor||null,u=t.borderWidth||null;n.pie=[{opacity:i},{opacity:t.hoveredOpacity||i},{opacity:t.selectedOpacity||i}],n.border=[{stroke:r,"stroke-width":u},{stroke:t.hoveredBorderColor||r,"stroke-width":t.hoveredBorderWidth||u},{stroke:t.selectedBorderColor||r,"stroke-width":t.selectedBorderWidth||u}]},_setState:function(n,t,i){e(n,t,i,"pie"),e(n,t,i,"border")},arrange:function(n,t){for(var e=t.length,s=n.settings.dataField,i,u=0,f,r=0;r<e;++r)i=p(t[r].proxy,s,"values"),i&&i.length>u&&(u=i.length);if(u>0){for(i=[],f=n.params.themeManager.createPalette(n.settings.palette,{useHighlight:!0}),r=0;r<u;++r)i.push(f.getNextColor());n.settings._colors=i,n.grouping.color={callback:o,field:"",partition:[],values:[]},n.params.dataExchanger.set(n.name,"color",{partition:[],values:i})}}},image:{_draw:function(n,t,i){t.image=n.renderer.image().attr({location:"center"}).data(n.dataKey,i).append(t.root)},refresh:function(n,t,i,r){t.image.attr({href:p(r,n.settings.dataField,"url")})},_getStyles:function(n,t){var i=t.size>0?r(t.size):0,u=i+(t.hoveredStep>0?r(t.hoveredStep):0),f=i+(t.selectedStep>0?r(t.selectedStep):0),e=t.opacity||null;n.image=[{x:-i/2,y:-i/2,width:i,height:i,opacity:e},{x:-u/2,y:-u/2,width:u,height:u,opacity:t.hoveredOpacity||e},{x:-f/2,y:-f/2,width:f,height:f,opacity:t.selectedOpacity||e}]},_setState:function(n,t,i){e(n,t,i,"image")}}},lt=function(n,t,i,r,u){var f;r&&t&&t.length>1&&(f=u(t.length-1),n.grouping[i]={callback:bt(r)?r:ar,field:r,partition:t,values:f},n.params.dataExchanger.set(n.name,i,{partition:t,values:f}))},nt=function(n){lt(n,n.settings.colorGroups,"color",n.settings.colorGroupingField,function(t){for(var u=n.params.themeManager.createGradientPalette(n.settings.palette,t),r=[],i=0;i<t;++i)r.push(u.getColor(i));return r})},at=function(n,t){var i=n.settings;lt(n,i.sizeGroups,"size",t||i.sizeGroupingField,function(n){var u=i.minSize>0?r(i.minSize):0,e=i.maxSize>=u?r(i.maxSize):0,t=0,f=[];if(n>1)for(t=0;t<n;++t)f.push((u*(n-t-1)+e*t)/(n-1));else n===1&&f.push((u+e)/2);return f})},b=function(t,i,r,u){var f=this;f._params=t,f._onProjection(),f.proxy=vr(f,r,u),f._context={name:r,layer:f.proxy,renderer:t.renderer,projection:t.projection,params:t,dataKey:t.dataKey,str:st,hover:!1,selection:null,grouping:{},root:t.renderer.g().attr({"class":"dxm-layer"}).linkOn(i,r).linkAppend()},f._container=i,f._dataSource=new n.viz.DataSource(function(){f._data=bi(f._dataSource.items()),f._update(!0)}),f._options={},f._handles=[],f._data=new ft},b.prototype={constructor:b,_onProjection:function(){var n=this;n._removeHandlers=n._params.projection.on({engine:function(){n._project()},screen:function(){n._transform()},center:function(){n._transformCore()},zoom:function(){n._transform()}})},_offProjection:function(){this._removeHandlers(),this._removeHandlers=null},dispose:function(){var n=this;return n._dataSource.dispose(),n._destroyHandles(),oi(n._context),n._context.root.linkRemove().linkOff(),n._context.labelRoot&&n._context.labelRoot.linkRemove().linkOff(),n._context.str.reset(n._context),n._offProjection(),n._params=n._container=n._context=n._dataSource=n.proxy=null,n},setOptions:function(n){var t=this;n=t._options=n||{},"data"in n&&n.data!==t._options_data?(t._options_data=n.data,t._params.notifyDirty(),t._dataSource.update(ki(n.data))):t._data.count()>0&&(t._params.notifyDirty(),t._update(n.type!==i&&n.type!==t._context.str.type||n.elementType!==i&&n.elementType!==t._context.str.elementType))},_update:function(n){var i=this,t=i._context;n&&(t.str.reset(t),t.root.clear(),t.labelRoot&&t.labelRoot.clear(),i._params.tracker.reset(),i._destroyHandles(),t.str=ii(i._options,i._data),t.str.setup(t),i.proxy.type=t.str.type,i.proxy.elementType=t.str.elementType),t.settings=lr(t.str.fullType,i._options,i._params.themeManager),t.hasSeparateLabel=!!(t.settings.label.enabled&&t.str.hasLabelsGroup),t.hover=!!li(t.settings.hoverEnabled,!0),t.selection&&a(t.selection.state,function(n,t){t&&t.resetSelected()}),t.selection=wi(t.settings.selectionMode),t.hasSeparateLabel?t.labelRoot||(t.labelRoot=t.renderer.g().attr({"class":"dxm-layer-labels"}).linkOn(i._container,{name:t.name+"-labels",after:t.name}).linkAppend(),i._transformCore()):t.labelRoot&&(t.labelRoot.linkRemove().linkOff(),t.labelRoot=null),n&&i._createHandles(),oi(t),t.str.arrange(t,i._handles),t.str.updateGrouping(t),i._updateHandles(),i._params.notifyReady()},_destroyHandles:function(){for(var t=this._handles,i=t.length,n=0;n<i;++n)t[n].dispose();this._context.selection&&(this._context.selection.state={}),this._handles=[]},_createHandles:function(){for(var t=this,r=t._handles=[],i=t._data,o=r.length=i.count(),u=t._context,s=i.geometry,h=i.attributes,f,e,n=0;n<o;++n)e=i.item(n),r[n]=new tt(u,n,s(e),h(e));for(bt(t._options.customize)&&(t._options._deprecated?gi:di)(t.getProxies(),t._options.customize,t._params.widget),t._options._deprecated&&nr(r,u.name,i),n=0;n<o;++n)f=r[n],f.project(),f.draw(),f.transform();u.selection&&a(u.selection.state,function(n,t){t&&t.restoreSelected()})},_updateHandles:function(){for(var t=this._handles,i=t.length,n=0;n<i;++n)t[n].refresh();if(this._context.settings.label.enabled){for(n=0;n<i;++n)t[n].measureLabel();for(n=0;n<i;++n)t[n].adjustLabel()}},_transformCore:function(){var n=this._params.projection.getTransform();this._context.root.attr(n),this._context.labelRoot&&this._context.labelRoot.attr(n)},_project:function(){for(var t=this._handles,i=t.length,n=0;n<i;++n)t[n].project()},_transform:function(){var t=this._handles,n,i=t.length;for(this._transformCore(),n=0;n<i;++n)t[n].transform()},getProxies:function(){for(var i=this._handles,t=[],r=t.length=i.length,n=0;n<r;++n)t[n]=i[n].proxy;return t},getProxy:function(n){return this._handles[n].proxy},raiseClick:function(n,t){this._params.eventTrigger("click",{target:this._handles[n].proxy,jQueryEvent:t})},hoverItem:function(n,t){this._handles[n].setHovered(t)},selectItem:function(n,t,i){this._handles[n].setSelected(t,i)},clearSelection:function(){var n=this._context.selection;n&&(a(n.state,function(n,t){t&&t.setSelected(!1)}),n.state={})}},tt=function(n,t,i,r){var u=this,e=u.proxy=yr(u,i.coordinates,f({},r));u._ctx=n,u._idx=t,u._fig=u._lbl=null,u._state=yi,u._coordinates=i.coordinates,u._settings={label:{}},e.index=t,e.layer=n.layer,u._data={name:n.name,index:t}},tt.prototype={constructor:tt,dispose:function(){var n=this;return n._ctx=n.proxy=n._settings=n._fig=n._lbl=n.data=null,n},project:function(){var n=this._ctx;this._prj=n.str.project(n.projection,this._coordinates),n.hasSeparateLabel&&this._lbl&&this._projectLabel()},_projectLabel:function(){this._labelPrj=this._ctx.str.projectLabel(this._prj)},draw:function(){var n=this,t=this._ctx;t.str.draw(t,n._fig={},n._data),n._fig.root.append(t.root)},transform:function(){var n=this,t=n._ctx;t.str.transform(n._fig,t.projection,n._prj),t.hasSeparateLabel&&n._lbl&&n._transformLabel()},_transformLabel:function(){this._ctx.str.transformLabel(this._lbl,this._ctx.projection,this._labelPrj)},refresh:function(){var n=this,i=n._ctx.str,t=hr(n._ctx,n.proxy,n._settings);n._styles=i.getStyles(t),i.refresh(n._ctx,n._fig,n._data,n.proxy,t),n._refreshLabel(t),n._setState()},_refreshLabel:function(n){var t=this,r=t._ctx,u=n.label,i=t._lbl;r.settings.label.enabled?(i||(i=t._lbl={root:r.labelRoot||t._fig.root,text:r.renderer.text().attr({"class":"dxm-label"}),size:[0,0]},r.hasSeparateLabel&&(t._projectLabel(),t._transformLabel())),i.value=si(t.proxy.text||t.proxy.attribute(u.dataField)||""),i.value&&(i.text.attr({text:i.value,x:0,y:0}).css(ai(u.font)).attr({align:"center",stroke:u.stroke,"stroke-width":u["stroke-width"],"stroke-opacity":u["stroke-opacity"]}).data(r.dataKey,t._data).append(i.root),i.settings=n)):i&&(i.text.remove(),t._lbl=null)},measureLabel:function(){var t=this._lbl,n;t.value&&(n=t.text.getBBox(),t.size=[n.width,n.height,-n.y-n.height/2])},adjustLabel:function(){var n=this._lbl,t;n.value&&(t=this._ctx.str.getLabelOffset(n,n.settings),n.settings=null,n.text.attr({x:t[0],y:t[1]+n.size[2]}))},update:function(n){var t=this;t._settings=ct(t._settings,n),t._fig&&(t.refresh(),t._lbl&&t._lbl.value&&(t.measureLabel(),t.adjustLabel()))},_setState:function(){this._ctx.str.setState(this._fig,this._styles,pi[this._state])},_setForeground:function(){var n=this._fig.root;this._state?n.toForeground():n.toBackground()},setHovered:function(n){var t=this,r=yt(t._state,dt),i=!!n;return t._ctx.hover&&r!==i&&(t._state=vt(t._state,dt,i),t._setState(),t._setForeground(),ei(t._ctx,t,i,"hoverChanged")),t},setSelected:function(n,t){var i=this,e=yt(i._state,k),u=!!n,r=i._ctx.selection,f;r&&e!==u&&(i._state=vt(i._state,k,u),f=r.state[r.single],r.state[r.single]=null,f&&f.setSelected(!1),r.state[r.single||i._idx]=n?i:null,i._fig&&(i._setState(),i._setForeground(),t||ei(i._ctx,i,u,"selectionChanged")))},isSelected:function(){return yt(this._state,k)},resetSelected:function(){this._state=vt(this._state,k,!1)},restoreSelected:function(){this._fig.root.toForeground()}},pt.prototype={constructor:pt,dispose:function(){var n=this;n._clip.dispose(),n._offTracker(),n._params=n._offTracker=n._layers=n._layerByName=n._clip=n._background=n._container=null},_subscribeToTracker:function(n,t,i){var r=this;r._offTracker=n.on({click:function(n){var u=t.getRootOffset(),f=r.byName(n.data.name);n.$event.x=n.x-u.left,n.$event.y=n.y-u.top,f?f.raiseClick(n.data.index,n.$event):n.data.name==="background"&&i("click",{jQueryEvent:n.$event})},"hover-on":function(n){var t=r.byName(n.data.name);t&&t.hoverItem(n.data.index,!0)},"hover-off":function(n){var t=r.byName(n.data.name);t&&t.hoverItem(n.data.index,!1)}})},setOptions:function(n){for(var r=n?n.length?n:[n]:[],u=this._layers,o=this._layerByName,s=this._params,h=this._container,f,i,t=r.length,e=u.length;t<e;++t)i=u[t],delete o[i.proxy.name],i.dispose();for(u.splice(r.length,u.length-r.length),t=u.length,e=r.length;t<e;++t)f=(r[t]||{}).name||"map-layer-"+t,i=u[t]=new b(s,h,f,t),o[f]=i;for(t=0,e=r.length;t<e;++t)f=r[t]&&r[t].name,i=u[t],f&&f!==i.proxy.name&&(delete o[i.proxy.name],i.dispose(),i=u[t]=new b(s,h,f,t),o[f]=i),i.setOptions(r[t])},_updateClip:function(){var n=this._rect,t=this._bw;this._clip.attr({x:n[0]+t,y:n[1]+t,width:u(n[2]-t*2,0),height:u(n[3]-t*2,0)})},setBackgroundOptions:function(n){this._background.attr({stroke:n.borderColor,"stroke-width":n.borderWidth,fill:n.color}),this._bw=u(n.borderWidth,0),this._updateClip()},setRect:function(n){this._rect=n,this._background.attr({x:n[0],y:n[1],width:n[2],height:n[3]}),this._updateClip()},byIndex:function(n){return this._layers[n]},byName:function(n){return this._layerByName[n]},items:function(){return this._layers}},n.viz.map.MapLayerCollection=pt}(DevExpress,jQuery),function(n){function i(n){this._subscribeToTracker(n.tracker,n.tooltip,n.layerCollection)}var r=12;i.prototype={constructor:i,dispose:function(){this._offTracker(),this._offTracker=null},_subscribeToTracker:function(n,t,i){this._offTracker=n.on({"focus-on":function(n){var e=!1,f,u;t.isEnabled()&&(f=i.byName(n.data.name),u=f&&f.getProxy(n.data.index),u&&t.show(u,{x:0,y:0,offset:0},{target:u})&&(t.move(n.x,n.y,r),e=!0)),n.done(e)},"focus-move":function(n){t.move(n.x,n.y,r)},"focus-off":function(){t.hide()}})}},n.viz.map.TooltipViewer=i}(DevExpress),DevExpress.MOD_VIZ_VECTORMAP=!0}